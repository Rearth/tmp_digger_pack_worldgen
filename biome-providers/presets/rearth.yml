precipitation-map: &precipitationMap
  type: "DOMAIN_WARP"
  amplitude: 120
  warp:
    type: "FBM"
    octaves: 3
    sampler:
      type: "OPEN_SIMPLEX_2S"
      frequency: 1 / ${meta.yml:precipationScale} * 2
  sampler:
    type: "OPEN_SIMPLEX_2"
    frequency: 1 / ${meta.yml:precipationScale}
    seed: 2345263



biomes:
  type: EXTRUSION
  extrusions: []
  provider:
    type: PIPELINE
    resolution: 2
    initial-size: 10
    blend:
      amplitude: 1.5
      sampler:
        type: WHITE_NOISE
    pipeline:
      source: $biome-providers/sources/land_only.yml:source
  
      stages:
        - type: REPLACE
          sampler:
            type: LINEAR
            min: 0.1
            max: 1
            sampler:
              type: EXPRESSION
              expression: continentalElevation(x, z)
          from: land
          to: 
            _lowlands: 10
            
            
        - type: REPLACE
          from: _lowlands
          sampler: *precipitationMap
          to:
            _wet: 1
            _semiwet: 1
            _semidry: 1
            _dry: 1


        - << biome-providers/stages/fill-biome-zones.yml:stages

        # ---
  

        # # add variants:

        # # ---
        # # Expansion and smoothing
        # # - Make biomes bigger + blend the borders to look more natural.
        - << biome-providers/stages/expand.yml:stages
        - << biome-providers/stages/expand.yml:stages
        - << biome-providers/stages/smooth.yml:stages
        - << biome-providers/stages/smooth.yml:stages
        # - << biome-providers/stages/smooth.yml:stages
        # - << biome-providers/stages/expand.yml:stages
        # - << biome-providers/stages/smooth.yml:stages
        # - << biome-providers/stages/smooth.yml:stages
        # - << biome-providers/stages/smooth.yml:stages
